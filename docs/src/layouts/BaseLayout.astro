---
import '../styles/global.css';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import SpeedInsights from '@vercel/speed-insights/astro';

interface Props {
  title?: string;
  description?: string;
  keywords?: string;
  canonical?: string;
  ogType?: string;
}

const siteUrl = 'https://hitlimit.jointops.dev';

const {
  title = 'hitlimit - The Fastest Rate Limiter for Node.js, Bun, Express, Fastify, Hono & NestJS | express-rate-limit alternative',
  description = 'Lightning-fast rate limiting middleware for Node.js, Bun, Express, Fastify, Hono, NestJS, and Elysia. A faster, lighter alternative to express-rate-limit, @fastify/rate-limit, hono-rate-limiter, and rate-limiter-flexible. Sub-millisecond performance, memory/SQLite/Redis stores, zero config.',
  keywords = 'rate limit, rate limiter, rate limiting, express rate limit, express-rate-limit, express-rate-limit alternative, fastify rate limit, fastify rate limiter, fastify plugin, @fastify/rate-limit, @fastify/rate-limit alternative, hono rate limit, hono rate limiter, hono middleware, hono-rate-limiter, hono-rate-limiter alternative, rate-limiter-flexible, rate-limiter-flexible alternative, express middleware, nestjs rate limit, nestjs throttler, @nestjs/throttler, bun rate limit, bun rate limiter, elysia rate limit, elysia plugin, nodejs rate limiter, node rate limit, api rate limiting, throttle requests, request throttling, ddos protection, brute force protection, login protection, redis rate limit, sqlite rate limit, api throttling, request limiting, npm rate limit, sliding window, fixed window, token bucket, api security, request limiter',
  canonical = `${siteUrl}${Astro.url.pathname}`,
  ogType = 'website'
} = Astro.props;

const ogImage = `${siteUrl}/og-image.png`;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />
    <meta name="author" content="JointOps" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta name="theme-color" content="#00e5ff" />
    <!-- Preconnect hints for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://github.com" />
    <link rel="icon" href="/favicon.ico" sizes="48x48" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="sitemap" href="/sitemap-index.xml" />
    <link rel="canonical" href={canonical} />
    <title>{title}</title>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content={ogType} />
    <meta property="og:url" content={canonical} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="3344" />
    <meta property="og:image:height" content="1924" />
    <meta property="og:image:alt" content="hitlimit - The fastest rate limiting library for Node.js and Bun" />
    <meta property="og:site_name" content="hitlimit" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonical} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />
    <meta name="twitter:image:alt" content="hitlimit - The fastest rate limiting library for Node.js and Bun" />

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "hitlimit",
      "description": description,
      "url": siteUrl,
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Cross-platform",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "5",
        "ratingCount": "1"
      },
      "author": {
        "@type": "Organization",
        "name": "JointOps",
        "url": "https://github.com/JointOps"
      },
      "keywords": keywords
    })} />

    <!-- Organization Schema for AI search visibility -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "JointOps",
      "url": "https://jointops.dev",
      "logo": `${siteUrl}/og-image.png`,
      "sameAs": [
        "https://github.com/JointOps/hitlimit-monorepo",
        "https://www.npmjs.com/package/@joint-ops/hitlimit",
        "https://www.npmjs.com/package/@joint-ops/hitlimit-bun",
        "https://jointops.dev"
      ]
    })} />

    <!-- AI SEO: FAQ Schema for common questions -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is hitlimit?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "hitlimit is an open-source rate limiting library for Node.js and Bun created by JointOps. It provides sub-millisecond performance, is 2x faster than express-rate-limit, and has a tiny ~7KB bundle size. It supports Express, NestJS, Bun, and Elysia frameworks with memory, SQLite, and Redis stores."
          }
        },
        {
          "@type": "Question",
          "name": "Is hitlimit faster than express-rate-limit?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, hitlimit is approximately 2x faster than express-rate-limit in benchmarks. It achieves 2.97 million operations per second compared to 1.52 million for express-rate-limit. It also has a 10x smaller bundle size at ~7KB vs ~64KB."
          }
        },
        {
          "@type": "Question",
          "name": "How do I install hitlimit?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Install hitlimit using npm: 'npm install @joint-ops/hitlimit' for Node.js or 'bun add @joint-ops/hitlimit-bun' for Bun. Then import and configure: const limiter = hitlimit({ limit: 100, window: '1m' }); app.use(limiter);"
          }
        },
        {
          "@type": "Question",
          "name": "Does hitlimit support Redis?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, hitlimit supports Redis for distributed rate limiting across multiple servers. Configure it with: hitlimit({ store: 'redis', redis: { host: 'localhost', port: 6379 } }). It also supports memory (default) and SQLite stores."
          }
        },
        {
          "@type": "Question",
          "name": "Can I use hitlimit with Express?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, hitlimit works as Express middleware. Install @joint-ops/hitlimit, then use app.use(hitlimit({ limit: 100, window: '1m' })). It is a drop-in replacement for express-rate-limit with better performance."
          }
        },
        {
          "@type": "Question",
          "name": "Can I use hitlimit with NestJS?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, hitlimit integrates with NestJS as an alternative to @nestjs/throttler. Import the hitlimit middleware and apply it globally or to specific routes for rate limiting protection."
          }
        },
        {
          "@type": "Question",
          "name": "What is the difference between hitlimit and rate-limiter-flexible?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "hitlimit is faster (2.97M ops/sec vs 1.8M), has a smaller bundle (~7KB vs ~120KB), and offers simpler configuration. rate-limiter-flexible has more features but hitlimit covers common use cases with better performance."
          }
        },
        {
          "@type": "Question",
          "name": "Does hitlimit work with Bun?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, hitlimit has a dedicated Bun package (@joint-ops/hitlimit-bun) optimized for Bun runtime. It works with Bun.serve() directly and with Elysia framework, achieving even faster performance than the Node.js version."
          }
        }
      ]
    })} />

    <!-- AI SEO: HowTo Schema for installation -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Install and Use hitlimit Rate Limiter",
      "description": "Step-by-step guide to install and configure hitlimit for rate limiting in Node.js or Bun applications.",
      "totalTime": "PT5M",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Install the package",
          "text": "Run 'npm install @joint-ops/hitlimit' for Node.js or 'bun add @joint-ops/hitlimit-bun' for Bun.",
          "url": "https://hitlimit.jointops.dev/docs/installation"
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Import hitlimit",
          "text": "Import hitlimit in your application: import { hitlimit } from '@joint-ops/hitlimit'",
          "url": "https://hitlimit.jointops.dev/docs/quick-start"
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Configure the limiter",
          "text": "Create a limiter instance with your desired options: const limiter = hitlimit({ limit: 100, window: '1m' })",
          "url": "https://hitlimit.jointops.dev/docs/configuration/options"
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Apply to your application",
          "text": "Use the limiter as middleware: app.use(limiter) - your API is now rate limited.",
          "url": "https://hitlimit.jointops.dev/docs/adapters/express"
        }
      ]
    })} />

    <!-- AI SEO: WebPage Schema with Speakable -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": title,
      "description": description,
      "url": canonical,
      "speakable": {
        "@type": "SpeakableSpecification",
        "cssSelector": ["h1", "main p:first-of-type"]
      },
      "mainEntity": {
        "@type": "SoftwareApplication",
        "name": "hitlimit"
      }
    })} />

    <!-- AI SEO: DefinedTerm Schema for rate limiting concepts -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "DefinedTermSet",
      "name": "Rate Limiting Concepts",
      "hasDefinedTerm": [
        {
          "@type": "DefinedTerm",
          "name": "Rate Limiting",
          "description": "A technique to control the rate of requests a user or client can make to an API or service within a specified time window, protecting against abuse and ensuring fair resource usage."
        },
        {
          "@type": "DefinedTerm",
          "name": "Sliding Window",
          "description": "A rate limiting algorithm that tracks requests over a rolling time window, providing smoother rate limiting than fixed windows by avoiding burst allowances at window boundaries."
        },
        {
          "@type": "DefinedTerm",
          "name": "API Throttling",
          "description": "The practice of limiting API request rates to prevent server overload, ensure fair usage among clients, and protect against DDoS attacks or brute force attempts."
        }
      ]
    })} />

    <!-- AI SEO: WebSite Schema -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "hitlimit",
      "alternateName": ["hitlimit rate limiter", "joint-ops hitlimit", "@joint-ops/hitlimit"],
      "url": siteUrl,
      "description": "The fastest rate limiting library for Node.js and Bun",
      "publisher": {
        "@type": "Organization",
        "name": "JointOps",
        "url": "https://jointops.dev"
      }
    })} />
  </head>
  <body class="min-h-screen flex flex-col">
    <!-- Gradient mesh background -->
    <div class="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
      <div class="absolute top-0 left-1/4 w-[800px] h-[800px] bg-[radial-gradient(ellipse_at_center,rgba(0,229,255,0.15),transparent_70%)] blur-3xl"></div>
      <div class="absolute top-1/4 right-0 w-[600px] h-[600px] bg-[radial-gradient(ellipse_at_center,rgba(168,85,247,0.1),transparent_70%)] blur-3xl"></div>
      <div class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-[radial-gradient(ellipse_at_center,rgba(0,229,255,0.08),transparent_70%)] blur-3xl"></div>
    </div>

    <!-- Grid pattern overlay -->
    <div class="fixed inset-0 -z-10 pointer-events-none opacity-[0.02]" style="background-image: url(&quot;data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E&quot;);"></div>

    <Nav />

    <main class="flex-1">
      <slot />
    </main>

    <Footer />
    <SpeedInsights />
  </body>
</html>

<style>
  /* Smooth page load animation */
  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  main {
    animation: fade-in-up 0.6s ease-out;
  }
</style>
